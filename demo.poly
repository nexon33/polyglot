
#[types]
type Tensor = rust:gridmesh::tensor::Tensor<f32> | python:gridmesh.Tensor

#[interface]
// Function visibility:
// - (default) = internal, only callable within this file
// - export = callable from other .poly files
// - public = callable from anywhere (FFI boundary)

export fn create_tensor(rows: u32, cols: u32) -> Tensor
export fn process_tensor(t: Tensor) -> Tensor
export fn print_tensor(t: Tensor)

#[rust]
fn create_tensor(rows: u32, cols: u32) -> Tensor {
    println!("Rust: Allocating {}x{} tensor", rows, cols);
    let shape = vec![rows as usize, cols as usize];
    Tensor::zeros(&shape)
}

fn print_tensor(t: Tensor) {
    println!("Rust: Inspecting Tensor: {:?}", t);
}

#[python]
def process_tensor(t: Tensor) -> Tensor:
    print(f"Python: Processing tensor of shape {t.shape}")
    return t

#[main]
fn main() {
    println!("Polyglot Runtime Init");
    
    // Create tensor in Rust
    let t = create_tensor(128, 128);
    
    // Process in Python (cross-language call!)
    let t2 = process_tensor(t);
    
    // Print result in Rust
    print_tensor(t2);
}
